    <style>
        @media print {
            @page {
                margin: 5mm;
                size: A4 landscape;
                @bottom-right {
                    content: "Page " counter(page) " of " counter(pages);
                    font-size: 9px;
                }
            }
            body { margin: 0; padding: 0; }
        }
        .page-number {
            position: fixed;
            bottom: 5mm;
            right: 5mm;
            font-size: 9px;
            color: #666;
        }
        @media screen {
            .page-number { display: none; }
        }
        .bordered-box {
            border: 1px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 5px;
            padding: 5px;
        }
        .bordered-box h4 {
            font-size: 14px;
            margin: 0;
            line-height: 1.4;
        }
        .empty-box {
            border: 1px solid #131212;
            padding: 5px;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 5px;
        }
        .page-footer {
            display: flex;
            justify-content: space-between;
            padding-top: 5px;
            border-top: 1px solid #ddd;
        }
        .qr-code {
            width: 40px;
            height: 40px;
        }
        .all-locations-qr {
            text-align: center;
            margin: 5px 0;
            padding: 8px;
            border: 1px solid #333;
            background: #f9f9f9;
        }
        .all-locations-qr img {
            width: 100px;
            height: 100px;
        }
        .all-locations-qr p {
            margin: 5px 0 0 0;
            font-weight: bold;
            font-size: 10px;
        }
        .header-title {
            font-size: 14px;
            margin: 0;
            line-height: 1.3;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table td, table th {
            vertical-align: middle !important;
            font-size: 11px;
            padding: 3px 5px !important;
            line-height: 1.3;
        }
        table th {
            background: #f0f0f0;
            font-weight: bold;
        }
        tfoot td {
            font-size: 11px;
            padding: 5px !important;
        }
        hr {
            margin: 5px 0;
        }
        small {
            font-size: 8px;
        }
    </style>
    <div class="container">
        <div class="row">
            <div class="col-xs-4">
                <div class="bordered-box">
                    <h4>
                        {%= filters.assigned_volunteer %} <br>
                        {%= data[0].volunteer_name %}<br>
                        {%= data[0].volunteer_mobile %}
                    </h4>
                </div>
            </div>
            <div class="col-xs-4">
                <h2 class="text-center header-title">{%= __("MILESTONE MANIYUR - BIRIYANI CHALLENGE") %}</h2>
            </div>
            <div class="col-xs-4">
                {%
                    var allCoords = [];
                    for (var j = 0; j < data.length; j++) {
                        if (data[j].coordinate && data[j].coordinate.includes(',')) {
                            var coords = data[j].coordinate.split(',');
                            var lat = coords[0].trim();
                            var lng = coords[1].trim();
                            if (parseFloat(lat) > 40) {
                                var temp = lat; lat = lng; lng = temp;
                            }
                            allCoords.push(lat + ',' + lng);
                        }
                    }
                    var allLocationsUrl = '';
                    if (allCoords.length > 0) {
                        allLocationsUrl = 'https://www.google.com/maps/dir/' + allCoords.join('/');
                    }
                %}
                {% if (allLocationsUrl) { %}
                <div class="all-locations-qr">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data={%= encodeURIComponent(allLocationsUrl) %}" alt="All Locations QR">
                    <p>Scan for All Locations Route</p>
                </div>
                {% } else { %}
                <div class="empty-box">
                    <p>No locations available</p>
                </div>
                {% } %}
            </div>
        </div>
    </div>
    <hr>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th style="width: 3%">{%= __("#") %}</th>
                <th style="width: 6%">{%= __("Job ID") %}</th>
                <th style="width: 13%">{%= __("Full Name") %}</th>
                <th style="width: 9%">{%= __("Mobile") %}</th>
                <th style="width: 10%">{%= __("Area") %}</th>
                <th style="width: 10%">{%= __("Address (Z-S-B-D)") %}</th>
                <th style="width: 5%">{%= __("Qty") %}</th>
                <th style="width: 7%">{%= __("Amount") %}</th>
                <th style="width: 7%">{%= __("Collected") %}</th>
                <th style="width: 7%">{%= __("Extra") %}</th>
                <th style="width: 6%">{%= __("Location") %}</th>
                <th style="width: 17%">{%= __("Remark") %}</th>
            </tr>
        </thead>
        <tbody>
            {% for (var i = 0, l = data.length; i < l; i++) { %}
                {%
                    var mapUrl = '';
                    if (data[i].coordinate && data[i].coordinate.includes(',')) {
                        var coords = data[i].coordinate.split(',');
                        var lat = coords[0].trim();
                        var lng = coords[1].trim();
                        if (parseFloat(lat) > 40) {
                            var temp = lat; lat = lng; lng = temp;
                        }
                        mapUrl = 'https://www.google.com/maps?q=' + lat + ',' + lng;
                    }
                    var totalAmount = (data[i].job_no || 0) * 20;
                %}
                <tr>
                    <td style="text-align: center">{%= i + 1 %}</td>
                    <td>{%= data[i].job_id %}</td>
                    <td>{%= data[i].job_name %}</td>
                    <td>{%= data[i].job_mobile %}</td>
                    <td>{%= data[i].job_area %}</td>
                    <td>
                        {% if (data[i].job_zone) { %}Z{%= data[i].job_zone %}{% } %}
                        {% if (data[i].street_number) { %} S{%= data[i].street_number %}{% } %}
                        {% if (data[i].job_build) { %} B{%= data[i].job_build %}{% } %}
                        {% if (data[i].door_number) { %} D{%= data[i].door_number %}{% } %}
                        {% if (data[i].compound_name) { %}<br><small>{%= data[i].compound_name %}</small>{% } %}
                    </td>
                    <td style="text-align: center">{%= data[i].job_no || 0 %}</td>
                    <td style="text-align: right">{%= totalAmount %}</td>
                    <td style="text-align: right"></td>
                    <td style="text-align: right"></td>
                    <td style="text-align: center">
                        {% if (mapUrl) { %}
                        <img class="qr-code" src="https://api.qrserver.com/v1/create-qr-code/?size=50x50&data={%= encodeURIComponent(mapUrl) %}" alt="QR">
                        {% } else { %}
                        -
                        {% } %}
                    </td>
                    <td>{%= data[i].remark || '' %}</td>
                </tr>
            {% } %}
        </tbody>
        <tfoot>
            {%
                var totalBiriyani = 0;
                for (var k = 0; k < data.length; k++) {
                    totalBiriyani += data[k].job_no || 0;
                }
            %}
            <tr style="background: #f0f0f0; font-weight: bold;">
                <td colspan="6" style="text-align: right;">Total ({%= data.length %} orders):</td>
                <td style="text-align: center;">{%= totalBiriyani %}</td>
                <td style="text-align: right;">{%= totalBiriyani * 20 %}</td>
                <td style="text-align: right;"></td>
                <td style="text-align: right;"></td>
                <td colspan="2"></td>
            </tr>
            <tr>
                <td colspan="6" style="text-align: right;"><strong>Collected:</strong></td>
                <td colspan="2" style="border-bottom: 1px solid #333;"></td>
                <td style="text-align: right;"><strong>Extra:</strong></td>
                <td colspan="3" style="border-bottom: 1px solid #333;"></td>
            </tr>
        </tfoot>
    </table>
